import{a as P,C as S,p as T,b as I,c as Y,L as j,d as z,e as K,P as M,f as O}from"./index-CcACpD41.js";import{d as Q,r as c,o as Z,w as A,c as G,a as m,b as i,e as t,f as p,g as b,h as o,u as H,i as V,j as J,F as R,k as W,l as r,t as v}from"./index-CHzXR4X7.js";async function X(h,l,n,s,_){return(await P.get("/api/incomes",{params:{key:h,dateFrom:s,dateTo:_,page:l,limit:n}})).data}const C=20,te=Q({__name:"Incomes",setup(h){S.register(T,I,Y,j,z,K,M);const l=c([]),n=c(!1),s=c(1),_=c(1),g=c("2024-01-01"),y=c("2024-12-31"),w="E6kUTYrYwZq2tN4QEtyzsbEBk3ie",f=async()=>{n.value=!0;try{const u=await X(w,s.value,C,g.value,y.value);l.value=u.data,_.value=u.meta.last_page??1}catch(u){console.error("Ошибка загрузки доходов:",u)}finally{n.value=!1}};Z(f),A([s],f);const x=G(()=>{const u=l.value.map(d=>d.date),e=l.value.map(d=>d.quantity);return{labels:u,datasets:[{label:"Количество поступлений",data:e,borderColor:"rgba(54, 162, 235, 1)",backgroundColor:"rgba(54, 162, 235, 0.2)",tension:.3,fill:!0}]}}),E={responsive:!0,plugins:{legend:{display:!0}}};return(u,e)=>{const d=o("v-text-field"),k=o("v-col"),B=o("v-row"),L=o("v-progress-circular"),N=o("v-table"),U=o("v-alert"),q=o("v-pagination"),D=o("v-container");return r(),m(D,null,{default:i(()=>[e[5]||(e[5]=t("h2",null,"Доходы",-1)),p(B,null,{default:i(()=>[p(k,{cols:"12",md:"3"},{default:i(()=>[p(d,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),label:"Дата от",type:"date",onChange:f},null,8,["modelValue"])]),_:1}),p(k,{cols:"12",md:"3"},{default:i(()=>[p(d,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=a=>y.value=a),label:"Дата до",type:"date",onChange:f},null,8,["modelValue"])]),_:1})]),_:1}),n.value?(r(),m(L,{key:0,indeterminate:"",color:"primary"})):b("",!0),!n.value&&l.value.length?(r(),m(H(O),{key:1,"chart-data":x.value,"chart-options":E,class:"mb-6"},null,8,["chart-data"])):b("",!0),!n.value&&l.value.length?(r(),m(N,{key:2},{default:i(()=>[e[3]||(e[3]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Дата"),t("th",null,"Артикул"),t("th",null,"Склад"),t("th",null,"Кол-во")])],-1)),t("tbody",null,[(r(!0),V(R,null,J(l.value,(a,F)=>(r(),V("tr",{key:a.income_id},[t("td",null,v(F+1+(s.value-1)*C),1),t("td",null,v(a.date),1),t("td",null,v(a.supplier_article),1),t("td",null,v(a.warehouse_name),1),t("td",null,v(a.quantity),1)]))),128))])]),_:1,__:[3]})):n.value?b("",!0):(r(),m(U,{key:3,type:"info"},{default:i(()=>e[4]||(e[4]=[W("Нет данных за выбранный период")])),_:1,__:[4]})),p(q,{modelValue:s.value,"onUpdate:modelValue":e[2]||(e[2]=a=>s.value=a),length:_.value,"total-visible":5,class:"mt-4"},null,8,["modelValue","length"])]),_:1,__:[5]})}}});export{te as default};
