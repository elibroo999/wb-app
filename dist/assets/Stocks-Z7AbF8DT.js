import{a as B,C as L,p as q,b as x,c as D,L as O,d as j,e as F,P,f as T}from"./index-CcACpD41.js";import{d as z,r as v,o as U,w as Y,c as I,a as c,b as m,e,g as y,f as K,h as i,u as M,i as b,j as Q,F as Z,k as A,l as r,t as u}from"./index-CHzXR4X7.js";async function G(h,n,l){const o=new Date().toISOString().split("T")[0];return(await B.get("/api/stocks",{params:{key:h,dateFrom:o,page:n,limit:l}})).data}const w=20,R=z({__name:"Stocks",setup(h){L.register(q,x,D,O,j,F,P);const n=v([]),l=v(!1),o=v(1),g=v(1),C="E6kUTYrYwZq2tN4QEtyzsbEBk3ie",f=async()=>{l.value=!0;try{const a=await G(C,o.value,w);console.log("Пример stock:",a.data[0]),n.value=a.data,g.value=a.meta.last_page??1}catch(a){console.error("Ошибка загрузки остатков:",a)}finally{l.value=!1}};U(f),Y(o,f);const N=I(()=>{const a=n.value.reduce((t,d)=>{const p=d.warehouse_name,_=Number(d.quantity);return t[p]=(t[p]||0)+(isNaN(_)?0:_),t},{});return{labels:Object.keys(a),datasets:[{label:"Остатки по складам",data:Object.values(a),borderColor:"rgba(255, 206, 86, 1)",backgroundColor:"rgba(255, 206, 86, 0.2)",tension:.3,fill:!0}]}}),S={responsive:!0,plugins:{legend:{display:!0}}};return(a,t)=>{const d=i("v-progress-circular"),p=i("v-table"),_=i("v-alert"),V=i("v-pagination"),E=i("v-container");return r(),c(E,null,{default:m(()=>[t[3]||(t[3]=e("h2",null,"Склады",-1)),l.value?(r(),c(d,{key:0,indeterminate:"",color:"primary"})):y("",!0),!l.value&&n.value.length?(r(),c(M(T),{key:1,"chart-data":N.value,"chart-options":S,class:"mb-6"},null,8,["chart-data"])):y("",!0),!l.value&&n.value.length?(r(),c(p,{key:2},{default:m(()=>[t[1]||(t[1]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Артикул"),e("th",null,"Размер"),e("th",null,"Штрихкод"),e("th",null,"Склад"),e("th",null,"Кол-во")])],-1)),e("tbody",null,[(r(!0),b(Z,null,Q(n.value,(s,k)=>(r(),b("tr",{key:k},[e("td",null,u(k+1+(o.value-1)*w),1),e("td",null,u(s.supplier_article||"—"),1),e("td",null,u(s.tech_size||"—"),1),e("td",null,u(s.barcode),1),e("td",null,u(s.warehouse_name),1),e("td",null,u(s.quantity),1)]))),128))])]),_:1,__:[1]})):l.value?y("",!0):(r(),c(_,{key:3,type:"info"},{default:m(()=>t[2]||(t[2]=[A("Нет данных за текущий день")])),_:1,__:[2]})),K(V,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value=s),length:g.value,"total-visible":5,class:"mt-4"},null,8,["modelValue","length"])]),_:1,__:[3]})}}});export{R as default};
